FROM node:8

ARG NODE_ENV=production
ENV NODE_ENV $NODE_ENV

ARG NODE_USE_YARN=false
ENV NODE_USE_YARN $NODE_USE_YARN

ARG NODE_USE_NPM=true
ENV NODE_USE_NPM $NODE_USE_NPM

ARG NODE_TEST_ENVIRONMENT_MOCHA=true
ENV NODE_TEST_ENVIRONMENT_MOCHA $NODE_TEST_ENVIRONMENT_MOCHA

ARG NODE_ISTANBUL_TEST_COVERAGE=true
ENV NODE_ISTANBUL_TEST_COVERAGE $NODE_ISTANBUL_TEST_COVERAGE 

ARG NODE_INSTALL_IMAGE_MAGICK=false
ENV NODE_INSTALL_IMAGE_MAGICK $NODE_INSTALL_IMAGE_MAGICK

RUN apt-get update

COPY ./scripts/custom-installations.sh /usr/bin/

RUN chmod 700 /usr/bin/custom-installations.sh

RUN /usr/bin/custom-installations.sh

WORKDIR /home/node/app
